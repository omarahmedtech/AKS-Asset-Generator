<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AKS Asset Generator</title>

  <!-- Favicon (you can replace with icon.png later) -->
  <link
    rel="icon"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' x='0.15em' font-size='80'%3EðŸ”§%3C/text%3E%3C/svg%3E"
  />

  <!-- Typography -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- Bootstrap (modern base styles) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- SheetJS for XLSX export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body data-theme="light">
  <!-- PIN overlay -->
  <div id="pin-overlay" class="pin-overlay">
    <div class="pin-card">
      <h2>Enter Access PIN</h2>
      <p class="pin-text">
        This tool is for internal use. Please enter the access PIN.
      </p>
      <input
        id="pin-input"
        class="pin-input"
        type="password"
        maxlength="6"
        autocomplete="off"
        placeholder="â€¢â€¢â€¢â€¢"
      />
      <div class="pin-error" id="pin-error" style="display:none;">
        Wrong PIN. Try again.
      </div>
      <button type="button" class="btn-primary pin-btn" id="pin-submit">
        Unlock
      </button>
    </div>
  </div>

  <main class="app-shell container-xl">
    <header>
      <div class="header-left">
        <img
          src="Hochschule_Aschaffenburg_Logo.svg.png"
          alt="TH Aschaffenburg logo"
          class="brand-logo"
        />
        <div class="title-block">
          <p class="eyebrow">Hochschule AB Â· internal</p>
          <h1>AKS Asset Generator</h1>
          <p class="subtitle">
            Generate GLT-ready asset IDs from the AKS catalog for many rooms in one go.
          </p>
        </div>
      </div>
      <div class="header-right">
        <button type="button" class="btn-secondary theme-toggle" id="theme-toggle">
          ðŸŒ™ Dark
        </button>
        <div class="chip">
          ðŸ”§ Automation Ops
        </div>
      </div>
    </header>

    <div class="modern-card card" id="input-card">
      <div class="card-header">
        <div>
          <h2>1. Input rows</h2>
          <span class="badge">Paste your room lists</span>
        </div>
        <span class="pill-info">
          Tip: One AKS type per row, many rooms per textarea
        </span>
      </div>
      <p class="small">
        For each row, choose a <strong>Gruppe</strong> and <strong>Anlagetyp</strong>, then enter
        <strong>GebÃ¤ude</strong> and <strong>RÃ¤ume</strong> (multiple allowed).<br />
        RÃ¤ume: <strong>eine pro Zeile</strong>. For multiple assets in one room, add <strong>xN</strong>:<br />
        <code>
          U05<br />
          U06 x4<br />
          U08 x2<br />
          E16 x2<br />
          E23 x3
        </code><br />
        The field <strong>Menge (Default)</strong> is used for rooms <em>without</em> an "xN".
      </p>

      <div class="input-table-header">
        <div>Gruppe</div>
        <div>Anlagetyp (Code â€“ Beschreibung)</div>
        <div>GebÃ¤ude</div>
        <div>RÃ¤ume</div>
        <div>Menge (Default)</div>
        <div></div>
      </div>

      <div id="input-rows"></div>

      <div class="btn-row">
        <button type="button" class="btn-secondary" id="add-row-btn">+ Add row</button>
        <button type="button" class="btn-primary" id="generate-btn">Generate assets</button>
      </div>
      <div id="input-error" class="error" style="display:none;"></div>
    </div>

    <div class="modern-card card">
      <div class="card-header">
        <div>
          <h2>2. Result table</h2>
          <span class="badge">Ready for Excel import</span>
        </div>
        <span class="pill-info" id="row-count-info">
          0 assets generated
        </span>
      </div>
      <p class="small">
        One row per generated asset. Menge per room is defined via <code>xN</code> or the default Menge field.<br />
        Click <strong>Download XLSX</strong> to save a file that you can open directly in Excel.
      </p>

      <div class="btn-row">
        <button type="button" class="btn-secondary" id="clear-results-btn">Clear results</button>
        <button type="button" class="btn-primary" id="download-xlsx-btn">Download XLSX</button>
        <button type="button" class="btn-primary" id="download-csv-btn">Download CSV</button>
      </div>

      <div class="scroll">
        <table class="table table-hover modern-table">
          <thead>
            <tr>
              <th>Gruppe Technischer Anlagen</th>
              <th>Technische Anlage</th>
              <th>Techn. Anlagen Nr.</th>
              <th>GLT-Code</th>
              <th>AnlagenprioritÃ¤t</th>
              <th>Kostenstelle</th>
              <th>GebÃ¤ude</th>
              <th>Raum</th>
              <th>Anlagetyp</th>
              <th>ID Raum</th>
              <th>Menge</th>
            </tr>
         </thead>
          <tbody id="result-body"></tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Logic -->
  <script src="script.js"></script>
</body>
</html>
